{"remainingRequest":"E:\\qingyunjiudian\\manager\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\qingyunjiudian\\manager\\src\\components\\Tinymce\\index.vue?vue&type=style&index=0&id=7e465e36&scoped=true&lang=css","dependencies":[{"path":"E:\\qingyunjiudian\\manager\\src\\components\\Tinymce\\index.vue","mtime":1560248274633},{"path":"E:\\qingyunjiudian\\manager\\node_modules\\css-loader\\index.js","mtime":1558690124086},{"path":"E:\\qingyunjiudian\\manager\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1521907989000},{"path":"E:\\qingyunjiudian\\manager\\node_modules\\postcss-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\qingyunjiudian\\manager\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558690126701},{"path":"E:\\qingyunjiudian\\manager\\node_modules\\vue-loader\\lib\\index.js","mtime":1527860006000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.tinymce-container {\n    position: relative;\n}\n.tinymce-container >>> .mce-fullscreen {\n    z-index: 10000;\n}\n.tinymce-textarea {\n    visibility: hidden;\n    z-index: -1;\n}\n.editor-custom-btn-container {\n    position: absolute;\n    right: 4px;\n    top: 4px;\n    /*z-index: 2005;*/\n}\n.fullscreen .editor-custom-btn-container {\n    z-index: 10000;\n    position: fixed;\n}\n.editor-upload-btn {\n    display: inline-block;\n}\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src\\components\\Tinymce","sourcesContent":["<template>\n  <div :class=\"{fullscreen:fullscreen}\" class=\"tinymce-container editor-container\">\n    <textarea :id=\"tinymceId\" class=\"tinymce-textarea\"/>\n  </div>\n</template>\n\n<script>\nimport {uploadFile } from \"../../api/file/upload\";\n\nexport default {\n    name: \"Tinymce\",\n    props: {\n        id: {\n            type: String,\n            default: function() {\n                return (\n                    \"vue-tinymce-\" +\n                    +new Date() +\n                    ((Math.random() * 1000).toFixed(0) + \"\")\n                );\n            }\n        },\n        value: {\n            type: String,\n            default: \"\"\n        },\n        toolbar: {\n            type: Array,\n            required: false,\n            default() {\n                return [\n                    \"searchreplace bold italic underline strikethrough alignleft aligncenter alignright outdent indent | blockquote undo redo removeformat subscript superscript code codesample\",\n                    \"hr bullist numlist link image charmap preview anchor pagebreak | insertdatetime media table forecolor backcolor fullscreen\"\n                ];\n            }\n        },\n        plugins: {\n            type: Array,\n            required: false,\n            default() {\n                return [\n                    \"advlist anchor autolink autosave code codesample colorpicker colorpicker contextmenu directionality emoticons fullscreen hr image imagetools importcss insertdatetime link lists media nonbreaking noneditable pagebreak paste preview print save searchreplace spellchecker tabfocus table template textcolor textpattern visualblocks visualchars wordcount\"\n                ];\n            }\n        },\n        menubar: {\n            type: String,\n            default: \"file edit insert view format table\"\n        },\n        height: {\n            type: Number,\n            required: false,\n            default: 360\n        }\n    },\n    data() {\n        return {\n            hasChange: false,\n            hasInit: false,\n            tinymceId: this.id,\n            fullscreen: false\n        };\n    },\n    computed: {},\n    watch: {\n        value(val) {\n            if (!this.hasChange && this.hasInit) {\n                this.$nextTick(() =>\n                    window.tinymce.get(this.tinymceId).setContent(val || \"\")\n                );\n            }\n        }\n    },\n    mounted() {\n        this.initTinymce();\n    },\n    activated() {\n        this.initTinymce();\n    },\n    deactivated() {\n        this.destroyTinymce();\n    },\n    destroyed() {\n        this.destroyTinymce();\n    },\n    methods: {\n        initTinymce() {\n            const _this = this;\n            window.tinymce.init({\n                language: \"zh_CN\",\n                selector: `#${this.tinymceId}`,\n                height: this.height,\n                body_class: \"panel-body\",\n                object_resizing: false,\n                toolbar: this.toolbar,\n                menubar: this.menubar,\n                plugins: this.plugins,\n                end_container_on_empty_block: true,\n                powerpaste_word_import: \"clean\",\n                code_dialog_height: 450,\n                code_dialog_width: 1000,\n                // advlist_bullet_styles: \"default\",\n                // advlist_number_styles: \"default\",\n                imagetools_cors_hosts: [\"www.tinymce.com\", \"codepen.io\"],\n                default_link_target: \"_blank\",\n                link_title: false,\n                nonbreaking_force_tab: true, // inserting nonbreaking space &nbsp; need Nonbreaking Space Plugin\n                convert_urls:false,\n                init_instance_callback: editor => {\n                    if (_this.value) {\n                        editor.setContent(_this.value);\n                    }\n                    _this.hasInit = true;\n                    editor.on(\"NodeChange Change KeyUp SetContent\", () => {\n                        this.hasChange = true;\n                        this.$emit(\"input\", editor.getContent());\n                    });\n                },\n                setup(editor) {\n                    editor.on(\"FullscreenStateChanged\", e => {\n                        _this.fullscreen = e.state;\n                    });\n                },\n                // 整合七牛上传\n                // images_dataimg_filter(img) {\n                //   setTimeout(() => {\n                //     const $image = $(img);\n                //     $image.removeAttr('width');\n                //     $image.removeAttr('height');\n                //     if ($image[0].height && $image[0].width) {\n                //       $image.attr('data-wscntype', 'image');\n                //       $image.attr('data-wscnh', $image[0].height);\n                //       $image.attr('data-wscnw', $image[0].width);\n                //       $image.addClass('wscnph');\n                //     }\n                //   }, 0);\n                //   return img\n                // },\n                images_upload_handler(blobInfo, success, failure, progress) {\n                    // formData.append(\"file\", blobInfo.blob());\n                    // qiniuUpload(formData)\n                    //     .then(response => {\n                    //         if (response.data.filePath) {\n                    //             success(response.data.filePath);\n                    //             progress(100);\n                    //             return;\n                    //         }\n                    //         failure(\"上传出错\");\n                    //     })\n                    //     .catch(() => {\n                    //         failure(\"上传出错\");\n                    //     });\n\n                    progress(0);\n                    const formData = new FormData();\n                    formData.append(\"chunk\", \"0\"); //断点传输\n                    formData.append(\"chunks\", \"1\");\n                    formData.append(\"file\", blobInfo.blob());\n                    uploadFile(formData)\n                        .then(response => {\n                            console.info(\"11111111\")\n                            console.info(response.data)\n                            success(response.data);\n                            progress(100);\n                            return;\n                        })\n                        .catch(() => {\n                            failure(\"上传出错\");\n                        });\n                }\n            });\n        },\n        destroyTinymce() {\n            if (window.tinymce.get(this.tinymceId)) {\n                window.tinymce.get(this.tinymceId).destroy();\n            }\n        },\n        setContent(value) {\n            window.tinymce.get(this.tinymceId).setContent(value);\n        },\n        getContent() {\n            window.tinymce.get(this.tinymceId).getContent();\n        },\n        clearContent() {\n            window.tinymce.get(this.tinymceId).setContent(\"\");\n        }\n    }\n};\n</script>\n\n<style scoped>\n.tinymce-container {\n    position: relative;\n}\n.tinymce-container >>> .mce-fullscreen {\n    z-index: 10000;\n}\n.tinymce-textarea {\n    visibility: hidden;\n    z-index: -1;\n}\n.editor-custom-btn-container {\n    position: absolute;\n    right: 4px;\n    top: 4px;\n    /*z-index: 2005;*/\n}\n.fullscreen .editor-custom-btn-container {\n    z-index: 10000;\n    position: fixed;\n}\n.editor-upload-btn {\n    display: inline-block;\n}\n</style>\n"]}]}