{"remainingRequest":"E:\\qingyunjiudian\\manager\\node_modules\\thread-loader\\dist\\cjs.js!E:\\qingyunjiudian\\manager\\node_modules\\babel-loader\\lib\\index.js!E:\\qingyunjiudian\\manager\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\qingyunjiudian\\manager\\src\\components\\Tinymce\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\qingyunjiudian\\manager\\src\\components\\Tinymce\\index.vue","mtime":1560248274633},{"path":"E:\\qingyunjiudian\\manager\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1558690126701},{"path":"E:\\qingyunjiudian\\manager\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1558690128857},{"path":"E:\\qingyunjiudian\\manager\\node_modules\\babel-loader\\lib\\index.js","mtime":1529635966000},{"path":"E:\\qingyunjiudian\\manager\\node_modules\\vue-loader\\lib\\index.js","mtime":1527860006000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.number.constructor\";\n//\n//\n//\n//\n//\n//\nimport { uploadFile } from \"../../api/file/upload\";\nexport default {\n  name: \"Tinymce\",\n  props: {\n    id: {\n      type: String,\n      default: function _default() {\n        return \"vue-tinymce-\" + +new Date() + ((Math.random() * 1000).toFixed(0) + \"\");\n      }\n    },\n    value: {\n      type: String,\n      default: \"\"\n    },\n    toolbar: {\n      type: Array,\n      required: false,\n      default: function _default() {\n        return [\"searchreplace bold italic underline strikethrough alignleft aligncenter alignright outdent indent | blockquote undo redo removeformat subscript superscript code codesample\", \"hr bullist numlist link image charmap preview anchor pagebreak | insertdatetime media table forecolor backcolor fullscreen\"];\n      }\n    },\n    plugins: {\n      type: Array,\n      required: false,\n      default: function _default() {\n        return [\"advlist anchor autolink autosave code codesample colorpicker colorpicker contextmenu directionality emoticons fullscreen hr image imagetools importcss insertdatetime link lists media nonbreaking noneditable pagebreak paste preview print save searchreplace spellchecker tabfocus table template textcolor textpattern visualblocks visualchars wordcount\"];\n      }\n    },\n    menubar: {\n      type: String,\n      default: \"file edit insert view format table\"\n    },\n    height: {\n      type: Number,\n      required: false,\n      default: 360\n    }\n  },\n  data: function data() {\n    return {\n      hasChange: false,\n      hasInit: false,\n      tinymceId: this.id,\n      fullscreen: false\n    };\n  },\n  computed: {},\n  watch: {\n    value: function value(val) {\n      var _this2 = this;\n\n      if (!this.hasChange && this.hasInit) {\n        this.$nextTick(function () {\n          return window.tinymce.get(_this2.tinymceId).setContent(val || \"\");\n        });\n      }\n    }\n  },\n  mounted: function mounted() {\n    this.initTinymce();\n  },\n  activated: function activated() {\n    this.initTinymce();\n  },\n  deactivated: function deactivated() {\n    this.destroyTinymce();\n  },\n  destroyed: function destroyed() {\n    this.destroyTinymce();\n  },\n  methods: {\n    initTinymce: function initTinymce() {\n      var _this3 = this;\n\n      var _this = this;\n\n      window.tinymce.init({\n        language: \"zh_CN\",\n        selector: \"#\".concat(this.tinymceId),\n        height: this.height,\n        body_class: \"panel-body\",\n        object_resizing: false,\n        toolbar: this.toolbar,\n        menubar: this.menubar,\n        plugins: this.plugins,\n        end_container_on_empty_block: true,\n        powerpaste_word_import: \"clean\",\n        code_dialog_height: 450,\n        code_dialog_width: 1000,\n        // advlist_bullet_styles: \"default\",\n        // advlist_number_styles: \"default\",\n        imagetools_cors_hosts: [\"www.tinymce.com\", \"codepen.io\"],\n        default_link_target: \"_blank\",\n        link_title: false,\n        nonbreaking_force_tab: true,\n        // inserting nonbreaking space &nbsp; need Nonbreaking Space Plugin\n        convert_urls: false,\n        init_instance_callback: function init_instance_callback(editor) {\n          if (_this.value) {\n            editor.setContent(_this.value);\n          }\n\n          _this.hasInit = true;\n          editor.on(\"NodeChange Change KeyUp SetContent\", function () {\n            _this3.hasChange = true;\n\n            _this3.$emit(\"input\", editor.getContent());\n          });\n        },\n        setup: function setup(editor) {\n          editor.on(\"FullscreenStateChanged\", function (e) {\n            _this.fullscreen = e.state;\n          });\n        },\n        // 整合七牛上传\n        // images_dataimg_filter(img) {\n        //   setTimeout(() => {\n        //     const $image = $(img);\n        //     $image.removeAttr('width');\n        //     $image.removeAttr('height');\n        //     if ($image[0].height && $image[0].width) {\n        //       $image.attr('data-wscntype', 'image');\n        //       $image.attr('data-wscnh', $image[0].height);\n        //       $image.attr('data-wscnw', $image[0].width);\n        //       $image.addClass('wscnph');\n        //     }\n        //   }, 0);\n        //   return img\n        // },\n        images_upload_handler: function images_upload_handler(blobInfo, success, failure, progress) {\n          // formData.append(\"file\", blobInfo.blob());\n          // qiniuUpload(formData)\n          //     .then(response => {\n          //         if (response.data.filePath) {\n          //             success(response.data.filePath);\n          //             progress(100);\n          //             return;\n          //         }\n          //         failure(\"上传出错\");\n          //     })\n          //     .catch(() => {\n          //         failure(\"上传出错\");\n          //     });\n          progress(0);\n          var formData = new FormData();\n          formData.append(\"chunk\", \"0\"); //断点传输\n\n          formData.append(\"chunks\", \"1\");\n          formData.append(\"file\", blobInfo.blob());\n          uploadFile(formData).then(function (response) {\n            console.info(\"11111111\");\n            console.info(response.data);\n            success(response.data);\n            progress(100);\n            return;\n          }).catch(function () {\n            failure(\"上传出错\");\n          });\n        }\n      });\n    },\n    destroyTinymce: function destroyTinymce() {\n      if (window.tinymce.get(this.tinymceId)) {\n        window.tinymce.get(this.tinymceId).destroy();\n      }\n    },\n    setContent: function setContent(value) {\n      window.tinymce.get(this.tinymceId).setContent(value);\n    },\n    getContent: function getContent() {\n      window.tinymce.get(this.tinymceId).getContent();\n    },\n    clearContent: function clearContent() {\n      window.tinymce.get(this.tinymceId).setContent(\"\");\n    }\n  }\n};",{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div :class=\"{fullscreen:fullscreen}\" class=\"tinymce-container editor-container\">\n    <textarea :id=\"tinymceId\" class=\"tinymce-textarea\"/>\n  </div>\n</template>\n\n<script>\nimport {uploadFile } from \"../../api/file/upload\";\n\nexport default {\n    name: \"Tinymce\",\n    props: {\n        id: {\n            type: String,\n            default: function() {\n                return (\n                    \"vue-tinymce-\" +\n                    +new Date() +\n                    ((Math.random() * 1000).toFixed(0) + \"\")\n                );\n            }\n        },\n        value: {\n            type: String,\n            default: \"\"\n        },\n        toolbar: {\n            type: Array,\n            required: false,\n            default() {\n                return [\n                    \"searchreplace bold italic underline strikethrough alignleft aligncenter alignright outdent indent | blockquote undo redo removeformat subscript superscript code codesample\",\n                    \"hr bullist numlist link image charmap preview anchor pagebreak | insertdatetime media table forecolor backcolor fullscreen\"\n                ];\n            }\n        },\n        plugins: {\n            type: Array,\n            required: false,\n            default() {\n                return [\n                    \"advlist anchor autolink autosave code codesample colorpicker colorpicker contextmenu directionality emoticons fullscreen hr image imagetools importcss insertdatetime link lists media nonbreaking noneditable pagebreak paste preview print save searchreplace spellchecker tabfocus table template textcolor textpattern visualblocks visualchars wordcount\"\n                ];\n            }\n        },\n        menubar: {\n            type: String,\n            default: \"file edit insert view format table\"\n        },\n        height: {\n            type: Number,\n            required: false,\n            default: 360\n        }\n    },\n    data() {\n        return {\n            hasChange: false,\n            hasInit: false,\n            tinymceId: this.id,\n            fullscreen: false\n        };\n    },\n    computed: {},\n    watch: {\n        value(val) {\n            if (!this.hasChange && this.hasInit) {\n                this.$nextTick(() =>\n                    window.tinymce.get(this.tinymceId).setContent(val || \"\")\n                );\n            }\n        }\n    },\n    mounted() {\n        this.initTinymce();\n    },\n    activated() {\n        this.initTinymce();\n    },\n    deactivated() {\n        this.destroyTinymce();\n    },\n    destroyed() {\n        this.destroyTinymce();\n    },\n    methods: {\n        initTinymce() {\n            const _this = this;\n            window.tinymce.init({\n                language: \"zh_CN\",\n                selector: `#${this.tinymceId}`,\n                height: this.height,\n                body_class: \"panel-body\",\n                object_resizing: false,\n                toolbar: this.toolbar,\n                menubar: this.menubar,\n                plugins: this.plugins,\n                end_container_on_empty_block: true,\n                powerpaste_word_import: \"clean\",\n                code_dialog_height: 450,\n                code_dialog_width: 1000,\n                // advlist_bullet_styles: \"default\",\n                // advlist_number_styles: \"default\",\n                imagetools_cors_hosts: [\"www.tinymce.com\", \"codepen.io\"],\n                default_link_target: \"_blank\",\n                link_title: false,\n                nonbreaking_force_tab: true, // inserting nonbreaking space &nbsp; need Nonbreaking Space Plugin\n                convert_urls:false,\n                init_instance_callback: editor => {\n                    if (_this.value) {\n                        editor.setContent(_this.value);\n                    }\n                    _this.hasInit = true;\n                    editor.on(\"NodeChange Change KeyUp SetContent\", () => {\n                        this.hasChange = true;\n                        this.$emit(\"input\", editor.getContent());\n                    });\n                },\n                setup(editor) {\n                    editor.on(\"FullscreenStateChanged\", e => {\n                        _this.fullscreen = e.state;\n                    });\n                },\n                // 整合七牛上传\n                // images_dataimg_filter(img) {\n                //   setTimeout(() => {\n                //     const $image = $(img);\n                //     $image.removeAttr('width');\n                //     $image.removeAttr('height');\n                //     if ($image[0].height && $image[0].width) {\n                //       $image.attr('data-wscntype', 'image');\n                //       $image.attr('data-wscnh', $image[0].height);\n                //       $image.attr('data-wscnw', $image[0].width);\n                //       $image.addClass('wscnph');\n                //     }\n                //   }, 0);\n                //   return img\n                // },\n                images_upload_handler(blobInfo, success, failure, progress) {\n                    // formData.append(\"file\", blobInfo.blob());\n                    // qiniuUpload(formData)\n                    //     .then(response => {\n                    //         if (response.data.filePath) {\n                    //             success(response.data.filePath);\n                    //             progress(100);\n                    //             return;\n                    //         }\n                    //         failure(\"上传出错\");\n                    //     })\n                    //     .catch(() => {\n                    //         failure(\"上传出错\");\n                    //     });\n\n                    progress(0);\n                    const formData = new FormData();\n                    formData.append(\"chunk\", \"0\"); //断点传输\n                    formData.append(\"chunks\", \"1\");\n                    formData.append(\"file\", blobInfo.blob());\n                    uploadFile(formData)\n                        .then(response => {\n                            console.info(\"11111111\")\n                            console.info(response.data)\n                            success(response.data);\n                            progress(100);\n                            return;\n                        })\n                        .catch(() => {\n                            failure(\"上传出错\");\n                        });\n                }\n            });\n        },\n        destroyTinymce() {\n            if (window.tinymce.get(this.tinymceId)) {\n                window.tinymce.get(this.tinymceId).destroy();\n            }\n        },\n        setContent(value) {\n            window.tinymce.get(this.tinymceId).setContent(value);\n        },\n        getContent() {\n            window.tinymce.get(this.tinymceId).getContent();\n        },\n        clearContent() {\n            window.tinymce.get(this.tinymceId).setContent(\"\");\n        }\n    }\n};\n</script>\n\n<style scoped>\n.tinymce-container {\n    position: relative;\n}\n.tinymce-container >>> .mce-fullscreen {\n    z-index: 10000;\n}\n.tinymce-textarea {\n    visibility: hidden;\n    z-index: -1;\n}\n.editor-custom-btn-container {\n    position: absolute;\n    right: 4px;\n    top: 4px;\n    /*z-index: 2005;*/\n}\n.fullscreen .editor-custom-btn-container {\n    z-index: 10000;\n    position: fixed;\n}\n.editor-upload-btn {\n    display: inline-block;\n}\n</style>\n"],"sourceRoot":"src\\components\\Tinymce"}]}